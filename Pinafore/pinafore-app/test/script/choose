#!/usr/bin/pinafore
let
import "pinafore-media";
import "pinafore-gnome";
in
run.GTK $ fn gtk => let

rec
    showFile: Action Unit
    = do
        file <- chooseExistingFile.GTK gtk $ match
            Just ("image",_) => True;
            _ => False;
            end;
        ref <- fileMakeRef.GIO file;
        lit <- get ref;
        let
        path = file >- match
                FileParseName.GIO path => path;
                _ => "unknown";
            end;
        in lit >- match
            image :? JPEGImage.Image => open.Window.GTK gtk (imageSize.Image image) {path} $ image.GTK {image};
            _ => outputLn.Env "not a JPEG image";
        end;
        showFile;
    end;
end;

in showFile
