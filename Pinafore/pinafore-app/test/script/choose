#!/usr/bin/pinafore
import "pinafore-media", "pinafore-gnome" in
run.GTK $ fn gtk =>
let rec

    showFile: Action Unit
    = do
        file <- chooseExistingFile.GTK gtk $ match
            Just ("image",_) => True;
            _ => False;
            end;
        ref <- makeRef.File.GIO file;
        jpeg <- get $ jpegMIME.JPEG.Image !$ ref;
        let
        path = file >- match
                Path.File.GIO path => path;
                _ => "unknown";
            end;
        image = interpret jpeg;
        in open.Window.GTK gtk (size.Image image) {path} $ image.Element.GTK {image};
        showFile;
    end;

in showFile
