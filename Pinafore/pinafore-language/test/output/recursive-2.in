#!/usr/bin/pinafore
let
using Function($,>-);
using Showable;
using Number;
using Integer;

fix: (a -> a) -> a
= fn f => let rec x = f x end in x;

recf: (Integer -> b -> Maybe b) -> Integer -> b -> Maybe b
= fns s a b => if a <= 0 then Just b else s (pred a) b;

f: Integer -> Integer -> Maybe Integer
= fix recf;
in outputLn.Env $ show $ f 2 5 >- match
    Just b => b;
    Nothing => 0;
    end
