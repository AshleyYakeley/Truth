#!/usr/bin/env pinafore1
let rec {
  ff =
    fn f => fn {
      Just a => Just $ f a;
      Nothing => Nothing;
    };

  manytimes =
    fn i,f,a =>
    i >- fn {
      0 => a;
      _ => manytimes (pred.Integer i) f $ f a;
    };
} do {
  outputLn.Env "START";
  outputLn.Env $ toText.Pinafore $ ff Just Nothing;
  outputLn.Env $ toText.Pinafore $ ff Just (Just Nothing);
  outputLn.Env $ toText.Pinafore $ (ff $ ff $ Just) (Just Nothing);
  outputLn.Env $ toText.Pinafore $ (ff $ ff $ Just) (Just $ Just Nothing);
  outputLn.Env $ toText.Pinafore $ manytimes 5 ff Just (Just $ Just $ Just $ Just Nothing);
  outputLn.Env $ toText.Pinafore $ manytimes 5 ff Just (Just $ Just $ Just $ Just $ Just Nothing);
  outputLn.Env "END";
}
