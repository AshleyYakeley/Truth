#!/usr/bin/env -S bash -e
while [[ ! -z "$1" ]]; do
    case "$1" in
        --build)
            stack build pinafore-app:pinafore
            shift 1
            ;;
        --clear)
            rm -f test/pinafore/tables.sqlite3
            shift 1
            ;;
        -i)
            stack --docker-env DISPLAY exec -- pinafore -I Pinafore/pinafore-stdlib/data --data test/pinafore -i
            shift 1
            ;;
        -*)
            echo "unknown option: $1" > /dev/stderr
            exit 1
            ;;
        *)
            stack --docker-env DISPLAY exec -- pinafore -I Pinafore/pinafore-stdlib/data --data test/pinafore "$1"
            shift 1
            ;;
    esac
done
